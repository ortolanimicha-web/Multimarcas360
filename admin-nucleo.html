<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin N칰cleo - Gesti칩n de Stock</title>
    
    <link rel="stylesheet" href="style.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        /* Estilo para las filas de promos din치micas */
.promo-row {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    align-items: center;
}
.promo-row input {
    margin-bottom: 0 !important; /* Quitar margen default de nucleo-input */
}
.btn-remove-row {
    background: #dc3545;
    color: white;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 4px;
    cursor: pointer;
}
        /* Estilos espec칤ficos para Admin N칰cleo (Dark Theme) */
        .nucleo-theme { font-family: 'Roboto', sans-serif; background-color: #f5f5f5; }
        .nucleo-theme .navbar { background-color: #000; border-bottom: 3px solid #6f42c1; }
        .nucleo-theme .logo { color: #fff; font-weight: 900; text-transform: uppercase; }
        .nucleo-theme .nav-links a { color: #fff; }
        
        /* Contenedor Admin */
        .nucleo-admin-container { max-width: 1200px; margin: 40px auto; padding: 20px; }
        
        /* Tarjetas de Formularios */
        .admin-card {
            background: #fff; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px; margin-bottom: 30px; border-left: 5px solid #6f42c1;
        }
        .admin-card h3 { margin-top: 0; color: #333; text-transform: uppercase; font-weight: 900; }
        
        /* Inputs estilo Nucleo */
        .nucleo-input {
            width: 100%; padding: 12px; margin-bottom: 15px;
            border: 2px solid #eee; border-radius: 4px; font-family: 'Roboto';
            transition: border 0.3s;
            box-sizing: border-box; /* Asegura que el padding no rompa el ancho */
        }
        .nucleo-input:focus { border-color: #6f42c1; outline: none; }
        
        /* Botones */
        .nucleo-btn-admin {
            background: #6f42c1; color: white; padding: 12px 25px;
            border: none; border-radius: 4px; font-weight: bold; cursor: pointer;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .nucleo-btn-admin:hover { background: #5a32a3; }
        .nucleo-btn-cancel { background: #dc3545; margin-left: 10px; }

        /* Tabla Dark */
        .nucleo-table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }
        .nucleo-table th { background: #000; color: #fff; padding: 15px; text-align: left; }
        .nucleo-table td { padding: 15px; border-bottom: 1px solid #eee; color: #333; }
        .nucleo-table tr:hover { background: #f9f9f9; }
        .action-btn { 
            padding: 5px 10px; border-radius: 4px; color: white; text-decoration: none; font-size: 0.8rem; cursor: pointer; border: none;
        }
        .btn-edit { background: #007bff; }
        .btn-delete { background: #dc3545; }

        /* Feedback */
        .feedback-msg { display: none; padding: 10px; margin-top: 10px; border-radius: 4px; text-align: center; font-weight: bold; }
        .feedback-success { background: #d4edda; color: #155724; }
        .feedback-error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body class="nucleo-theme">

    <nav class="navbar">
        <div class="logo">Admin N칰cleo</div>
        <ul class="nav-links">
            <li><a href="productos-nucleo.html">Ver Tienda</a></li>
            <li><a href="admin.html">Admin General</a></li>
            <li><button id="logout-btn-nucleo" style="background:none; border:none; color:white; cursor:pointer;">Salir</button></li>
        </ul>
    </nav>

    <main class="nucleo-admin-container">
        
        <section class="admin-card">
            <h3>1. Categor칤as N칰cleo</h3>
            <form id="nucleo-category-form">
                <input type="text" id="nucleo-cat-name" class="nucleo-input" placeholder="Nombre de la Categor칤a (Ej: Audio, Gaming...)" required>
                <input type="text" id="nucleo-cat-img" class="nucleo-input" placeholder="URL Imagen Categor칤a (Opcional)">
                <button type="submit" class="nucleo-btn-admin">Crear Categor칤a</button>
                <div id="feedback-cat" class="feedback-msg"></div>
            </form>
            
            <div style="margin-top: 20px; max-height: 200px; overflow-y: auto;">
                <table class="nucleo-table">
                    <thead><tr><th>Categor칤a</th><th>Acci칩n</th></tr></thead>
                    <tbody id="nucleo-cat-table-body"></tbody>
                </table>
            </div>
        </section>

        <section class="admin-card">
            <h3>2. Productos N칰cleo</h3>
            <form id="nucleo-product-form">
    <input type="hidden" id="nucleo-edit-id"> 
    
    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
        <input type="text" id="nucleo-prod-name" class="nucleo-input" placeholder="Nombre del Producto" required style="flex: 2; min-width: 200px;">
        <input type="number" id="nucleo-prod-price" class="nucleo-input" placeholder="Precio Minorista" required style="flex: 1; min-width: 120px;">
    </div>

    <input type="number" id="nucleo-prod-wholesale" class="nucleo-input" placeholder="Precio Mayorista (Opcional - Venta x Mayor)">

    <div style="background: #fff; border: 2px solid #eee; padding: 15px; border-radius: 4px; margin-bottom: 15px;">
        <h4 style="margin-top:0; color:#6f42c1;">Promociones por Cantidad</h4>
        <small style="display:block; margin-bottom:10px; color:#666;">Define escalas (Ej: Llevando 5, cada uno sale $1000)</small>
        
        <div id="nucleo-promos-container"></div>

        <button type="button" id="btn-add-promo-row" class="nucleo-btn-admin" style="background-color: #28a745; font-size: 0.8rem; padding: 8px 15px;">
            <i class="fas fa-plus"></i> Agregar Escala
        </button>
    </div>

    <select id="nucleo-prod-category" class="nucleo-input" required>
        <option value="">-- Selecciona Categor칤a --</option>
    </select>

    <div style="margin-bottom: 15px; border: 2px solid #eee; padding: 10px; border-radius: 4px; background: #fff;">
        <label for="nucleo-prod-date" style="display:block; margin-bottom:5px; font-weight:bold; color:#555;">游늰 Fecha de Creaci칩n (Ordenamiento):</label>
        <input type="datetime-local" id="nucleo-prod-date" class="nucleo-input" style="margin-bottom:0;">
        <small style="display:block; margin-top:5px; color:#777;">Si lo dejas vac칤o, usa la fecha actual.</small>
    </div>

    <textarea id="nucleo-prod-imgs" class="nucleo-input" rows="3" placeholder="URLs de im치genes (una por l칤nea)" required></textarea>
    
    <textarea id="nucleo-prod-desc" class="nucleo-input" rows="3" placeholder="Descripci칩n detallada..."></textarea>

    <button type="submit" id="btn-save-prod" class="nucleo-btn-admin">Guardar Producto</button>
    <button type="button" id="btn-cancel-prod" class="nucleo-btn-admin nucleo-btn-cancel" style="display: none;">Cancelar</button>
    
    <div id="feedback-prod" class="feedback-msg"></div>
</form>
        </section>

        <section class="admin-card">
            <h3>Inventario Actual</h3>
            <p id="loading-stock">Cargando inventario...</p>
            <div style="overflow-x: auto;">
                <table class="nucleo-table">
                    <thead>
                        <tr>
                            <th>Img</th>
                            <th>Producto</th>
                            <th>Categor칤a</th>
                            <th>Precio</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="nucleo-stock-body">
                    </tbody>
                </table>
            </div>
        </section>

    </main>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCD4lBf6BA76Oz-SDr4f8eaPA-q7v5AecY",
            authDomain: "consultoravidal91.firebaseapp.com",
            projectId: "consultoravidal91",
            storageBucket: "consultoravidal91.firebasestorage.app",
            messagingSenderId: "840042202477",
            appId: "1:840042202477:web:aae77961b4bca465dc4664",
            measurementId: "G-HP3L0WZ60V"
        };
        // Inicializar Firebase solo si no existe ya
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();
        const auth = firebase.auth();
        const ADMIN_EMAIL = 'ortolanimichael@gmail.com';
    </script>
    <script src="app.js"></script>
</body>
</html>